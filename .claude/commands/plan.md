# Plan コマンド仕様書

## 概要
[ultrathink] Claude Code が **Plan mode** で動作する際に呼び出すコマンドです。ユーザーから渡される `$ARGUMENT` をもとに実装計画を立案・提示します。本書はその振る舞いと記述フォーマットを定義します。

---

## 基本ルール
1. **モード判定**  
   ユーザーが **`/Act`** と明示しない限り、エージェントは Plan mode として振る舞います。
2. **ユーザー入力の解釈**  
   Plan mode では、ユーザーの入力 (＝`$ARGUMENT`) を *実装計画の立案依頼* と見做します。
3. **出力内容**  
   - 現状の実装を参照し、実装すべき箇所や変更点を具体的に示すこと。
   - 適切な詳細度で工程を分解し、箇条書きやテーブルを活用して整理すること。
   - ユーザーとの認識齟齬を防ぐため、**必要に応じてコードスニペットを積極的に挿入**すること。
   - 懸念点・想定リスクがあれば忌憚なく記載すること。
4. **Act mode への誘導**  
   計画提示後、実装着手が必要であればユーザーに `/Act` への切替を促してください。

---

## 入力仕様
```
plan "$ARGUMENT"
```
- `$ARGUMENT`: ユーザーが実装したい内容や要件を自然言語で記述した文字列。

### 例
```
plan "ブログ記事を Markdown で保存し、SSG で静的生成する機能を追加してください"
```

---

## 出力テンプレート
以下は Plan コマンドが返す Markdown テンプレート例です。状況に応じて節を追加・省略して構いません。

```md
### 🎯 目的
$ARGUMENT から読み取った目的を 1 文で要約。

### 🗂 変更対象
- 例) `src/pages/index.tsx`
- 例) `components/BlogPostCard.tsx`

### 🛠 実装ステップ
1. ステップ 1 の説明 (必要ならコードスニペット)
2. ステップ 2 の説明
   ```tsx
   // 例: コード断片
   ```
3. ...

### ⚠️ 懸念・確認事項
- 懸念点 A
- 確認事項 B

### 🚀 次アクション
`/Act` とコメントすると上記手順で実装を開始します。
```

---

## 注意事項
- **冗長な説明を避け、読みやすさを優先**してください。
- コードラインは実際の行番号付き引用 (`startLine:endLine:path`) 形式を用いてください。
- 既存ファイルを編集する場合は、変更箇所のみを `// ... existing code ...` で挟み込むフォーマットを遵守してください。